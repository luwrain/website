
ENTITLE='Preparing a speech back-end'
RUTITLE='Реализация речевого вывода'
TARGET=doc/devel/speech-backend/index.php

luwrain-page-en

= Preparing a speech back-end =

This page is currently available only in~Russian language.

luwrain-page-ru

= Реализация речевого вывода =

См.~также

* [/api/org/luwrain/speech/BackEnd.html Страница {{org.luwrain.speech.BackEnd}} в~Luwrain~API].

Передача информации в~виде синтезированной человеческой речи является одним из~основных альтернативных способов  взаимодействия пользователя с~Luwrain.
Дизайн Luwrain подразумевает возможность подготовки большого количества разнообразных механизмов вывода речи,
фиксируя единый интерфейс,
которому должны они все удовлетворять.
Очевидно, что пути вызова речевых синтезаторов и воспроизведения звука будут отличаться от~одной операционной системы к~другой,
поскольку современная реализация Java не~имеет достаточно развитого единого   программного интерфейса для~речевой подсистемы.

== Особенности вывода речи в~Luwrain ==

Вывод речи в~Luwrain обладает следующими особенностями:

* реализация должна выполнять как~вызов речевых синтезаторов, так и воспроизведение звука;

* возврат синтезированного сигнала обратно в~Luwrain не~осуществляется;

* фрагменты текста на~чтение, посланные разными командами,
помещаются в~очередь, если последующая команда приходит до~окончания чтения текста предыдущей;

* контекст вывода речи предусматривает наличие двух параметров по~умолчанию:
высоты голоса и темпа чтения;
эти~значения используются,
если команда на~чтение не~содержала точных указаний,
с~какой высотой и с~какой скоростью производить чтение;

* различаются команды на~чтение текста и на~чтение букв 
(команда на~чтение отдельных букв различает прописные и строчные буквы, выделяя прописные увеличением высоты голоса).

Как и во~всех подобных приложениях,
в~Luwrain скорость отклика является критически важной.
Это актуально как для~команды чтения, так и для~команды остановки чтения.

== Порядок загрузки ==

Любая реализация вывода речи обязана удовлетворять интерфейсу 
[/api/org/luwrain/speech/BackEnd.html {{org.luwrain.speech.BackEnd}}].
Во~время запуска класс {{org.luwrain.core.Init}} создаёт при~помощи {{Class.forName()}} экземпляр класса,
имя которого  ожидает заданным при~помощи параметра командной строки {{\-\-speech=}}.
Если этот параметр отсутствует или содержит пустое значение, то загрузка Luwrain прерывается.
Если загруженный класс не~удовлетворяет интерфейсу {{org.luwrain.speech.backEnd}},
то загрузка прерывается тоже.

Если экземпляр класса удалось создать, то у~него вызывается метод {{init()}},
в~который передаётся полный вид командной строки.
Метод {{init()}}  может произвести  её самостоятельный разбор и проверить, нет ли в~ней параметров, 
предназначенных конкретно для~него 
(основной код Luwrain не~требует, чтобы указывались только известные параметры).
Если инициализация была проведена успешно,
то необходимо вернуть значение {{null}},
в~противном случае возвращается строка с~однострочным описанием ошибки на~английском языке.
Если была возвращена строка, то Luwrain считает,
что подготовить  вывод речи не~удалось, и прекращает загрузку.

Реализация вывода речи может находиться в~любом jar-файле, указанном при помощи {{-classpath}}.

== Параметры речи ==

Любой речевой фрагмент всегда имеет два ассоциированных с~ним значения: высоту  голоса и скорость речи.
В~традициях Luwrain они должны находиться  в~интервале от~0 до 100 включительно.
Как эти значения будут отображаться на~множество реальных значений конкретного синтезатора, каждая реализация  определяет самостоятельно.
Оба параметра могут быть переданы явно в~методы {{say()}} и {{sayLetter()}}.
Если использована форма, которая их не~учитывает,
то должны использоваться значения, 
заданные ранее при~помощи методов {{setDefaultPitch()}} и {{setDefaultRate()}}.
До~вызова этих методов рекомендуется считать, что скорость и высота речи равны 50.

